<!--
Copyright (c) 2015 DudeTeam. All rights reserved.
Authored by Maxime Perrimond <max.perrimond@gmail.com>
-->
<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="demo-panel.html">
<link rel="import" href="demo-fruits.html">
<link rel="import" href="../magnet-editor.html">

<dom-module id="demo-editor">

    <style>
        :host {
            display: flex;
            flex: 1;
        }
    </style>

    <template>
        <content></content>
    </template>

    <script>
        Polymer({
            is: "demo-editor",

            properties: {
                config: {
                    type: Object,
                    value: {
                        type: "dock",
                        horizontal: true,
                        sub: [
                            {
                                type: "dock",
                                sub: [
                                    {
                                        type: "block",
                                        "selected": 1,
                                        sub: [
                                            {
                                                type: "panel",
                                                title: "Scene editor",
                                                panel: "DemoPanel"
                                            },
                                            {
                                                type: "panel",
                                                title: "Graph editor",
                                                panel: "DemoFruits"
                                            }
                                        ]
                                    },
                                    {
                                        type: "block",
                                        sub: [
                                            {
                                                type: "panel",
                                                title: "Debugger",
                                                panel: "DemoPanel"
                                            }
                                        ]
                                    },
                                    {
                                        type: "block",
                                        sub: [
                                            {
                                                type: "panel",
                                                title: "Console",
                                                panel: "DemoPanel"
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                type: "dock",
                                sub: [
                                    {
                                        type: "block",
                                        selected: 1,
                                        sub: [
                                            {
                                                type: "panel",
                                                title: "Inspector",
                                                panel: "DemoPanel"
                                            },
                                            {
                                                type: "panel",
                                                title: "Entities",
                                                panel: "DemoFruits"
                                            }
                                        ]
                                    },
                                    {
                                        type: "block",
                                        sub: [
                                            {
                                                title: "Resources",
                                                panel: "DemoPanel",
                                                type: "panel"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                }
            },

            ready: function () {
                var editor = new MagnetEditor();
                Polymer.dom(this).appendChild(editor);
                editor.config = this.config;
                editor.load();
                editor.flush();
                this._width = window.innerWidth;
                this._height = window.innerHeight;
                window.addEventListener("resize", function () {
                    var deltaX = window.innerWidth - this._width;
                    var deltaY = window.innerHeight - this._height; // take size in account?
                    this._width = window.innerWidth;
                    this._height = window.innerHeight;
                    editor.resizeEditor(deltaX, deltaY);
                }.bind(this));
            }
        });
    </script>

</dom-module>